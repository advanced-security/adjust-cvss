name: 'Adjust  CVSS'
description: 'Adjust the CVSS scores of CodeQL queries'
inputs:
  patterns:
    description: 'Score patterns'
    required: true
  input:
    description: 'Path to the input SARIF file'
    required: true
  output:
    description: 'Path to the output SARIF file'
    required: true
runs:
  using: "composite"
  steps:
    - name: adjust
      env:
        GITHUB_ACTION_PATH: ${{ github.action_path }}
        INPUT: ${{ inputs.input }}
        OUTPUT: ${{ inputs.output }}
        PATTERNS: ${{ inputs.patterns }}
      run: |
        unset LD_PRELOAD
        python3 "$GITHUB_ACTION_PATH/adjust_cvss.py" --input "$INPUT" --output "$OUTPUT" --split-lines -- "$PATTERNS"
      shell: bash
